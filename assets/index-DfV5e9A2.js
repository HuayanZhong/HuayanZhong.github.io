import{e as ve,T as W,c as j,t as O,n as K,m as Y,u as fe,R as de,p as he,S as U,U as ge,V as me,E as _,x as we,v as k,w as G,a as Te}from"./index-CoLxLmKc.js";import{g as be,r as y,d as q,h as J,a as T,i as A,j as Q,G as ye,D as xe,y as Se,c as D,n as Z}from"./index-45IKlSZ7.js";import{o as pe}from"./use-placeholder-Fv3Yvx8G.js";function ee(t){const u=be();u&&ve(u.proxy,t)}function Ce(t,u){return t>u?"horizontal":u>t?"vertical":""}function Ee(){const t=y(0),u=y(0),f=y(0),o=y(0),s=y(0),e=y(0),d=y(""),c=y(!0),b=()=>d.value==="vertical",v=()=>d.value==="horizontal",i=()=>{f.value=0,o.value=0,s.value=0,e.value=0,d.value="",c.value=!0};return{move:m=>{const S=m.touches[0];f.value=(S.clientX<0?0:S.clientX)-t.value,o.value=S.clientY-u.value,s.value=Math.abs(f.value),e.value=Math.abs(o.value);const p=10;(!d.value||s.value<p&&e.value<p)&&(d.value=Ce(s.value,e.value)),c.value&&(s.value>W||e.value>W)&&(c.value=!1)},start:m=>{i(),t.value=m.touches[0].clientX,u.value=m.touches[0].clientY},reset:i,startX:t,startY:u,deltaX:f,deltaY:o,offsetX:s,offsetY:e,direction:d,isVertical:b,isHorizontal:v,isTap:c}}const[te,$]=j("swipe"),Pe={loop:O,width:K,height:K,vertical:Boolean,autoplay:Y(0),duration:Y(500),touchable:O,lazyRender:Boolean,initialSwipe:Y(0),indicatorColor:String,showIndicators:O,stopPropagation:O},ae=Symbol(te);var Ie=q({name:te,props:Pe,emits:["change","dragStart","dragEnd"],setup(t,{emit:u,slots:f}){const o=y(),s=y(),e=J({rect:null,width:0,height:0,offset:0,active:0,swiping:!1});let d=!1;const c=Ee(),{children:b,linkChildren:v}=fe(ae),i=T(()=>b.length),r=T(()=>e[t.vertical?"height":"width"]),h=T(()=>t.vertical?c.deltaY.value:c.deltaX.value),m=T(()=>e.rect?(t.vertical?e.rect.height:e.rect.width)-r.value*i.value:0),S=T(()=>r.value?Math.ceil(Math.abs(m.value)/r.value):i.value),p=T(()=>i.value*r.value),C=T(()=>(e.active+i.value)%i.value),R=T(()=>{const a=t.vertical?"vertical":"horizontal";return c.direction.value===a}),ie=T(()=>{const a={transitionDuration:`${e.swiping?0:t.duration}ms`,transform:`translate${t.vertical?"Y":"X"}(${+e.offset.toFixed(2)}px)`};if(r.value){const l=t.vertical?"height":"width",n=t.vertical?"width":"height";a[l]=`${p.value}px`,a[n]=t[n]?`${t[n]}px`:""}return a}),ne=a=>{const{active:l}=e;return a?t.loop?k(l+a,-1,i.value):k(l+a,0,S.value):l},B=(a,l=0)=>{let n=a*r.value;t.loop||(n=Math.min(n,-m.value));let w=l-n;return t.loop||(w=k(w,m.value,0)),w},x=({pace:a=0,offset:l=0,emitChange:n})=>{if(i.value<=1)return;const{active:w}=e,g=ne(a),z=B(g,l);if(t.loop){if(b[0]&&z!==m.value){const X=z<m.value;b[0].setOffset(X?p.value:0)}if(b[i.value-1]&&z!==0){const X=z>0;b[i.value-1].setOffset(X?-p.value:0)}}e.active=g,e.offset=z,n&&g!==w&&u("change",C.value)},M=()=>{e.swiping=!0,e.active<=-1?x({pace:i.value}):e.active>=i.value&&x({pace:-i.value})},le=()=>{M(),c.reset(),_(()=>{e.swiping=!1,x({pace:-1,emitChange:!0})})},N=()=>{M(),c.reset(),_(()=>{e.swiping=!1,x({pace:1,emitChange:!0})})};let H;const P=()=>clearTimeout(H),I=()=>{P(),+t.autoplay>0&&i.value>1&&(H=setTimeout(()=>{N(),I()},+t.autoplay))},E=(a=+t.initialSwipe)=>{if(!o.value)return;const l=()=>{var n,w;if(!U(o)){const g={width:o.value.offsetWidth,height:o.value.offsetHeight};e.rect=g,e.width=+((n=t.width)!=null?n:g.width),e.height=+((w=t.height)!=null?w:g.height)}i.value&&(a=Math.min(i.value-1,a),a===-1&&(a=i.value-1)),e.active=a,e.swiping=!0,e.offset=B(a),b.forEach(g=>{g.setOffset(0)}),I()};U(o)?Z().then(l):l()},V=()=>E(e.active);let F;const oe=a=>{!t.touchable||a.touches.length>1||(c.start(a),d=!1,F=Date.now(),P(),M())},se=a=>{t.touchable&&e.swiping&&(c.move(a),R.value&&(!t.loop&&(e.active===0&&h.value>0||e.active===i.value-1&&h.value<0)||(we(a,t.stopPropagation),x({offset:h.value}),d||(u("dragStart",{index:C.value}),d=!0))))},L=()=>{if(!t.touchable||!e.swiping)return;const a=Date.now()-F,l=h.value/a;if((Math.abs(l)>.25||Math.abs(h.value)>r.value/2)&&R.value){const w=t.vertical?c.offsetY.value:c.offsetX.value;let g=0;t.loop?g=w>0?h.value>0?-1:1:0:g=-Math[h.value>0?"ceil":"floor"](h.value/r.value),x({pace:g,emitChange:!0})}else h.value&&x({pace:0});d=!1,e.swiping=!1,u("dragEnd",{index:C.value}),I()},ce=(a,l={})=>{M(),c.reset(),_(()=>{let n;t.loop&&a===i.value?n=e.active===0?0:a:n=a%i.value,l.immediate?_(()=>{e.swiping=!1}):e.swiping=!1,x({pace:n-e.active,emitChange:!0})})},ue=(a,l)=>{const n=l===C.value,w=n?{backgroundColor:t.indicatorColor}:void 0;return D("i",{style:w,class:$("indicator",{active:n})},null)},re=()=>{if(f.indicator)return f.indicator({active:C.value,total:i.value});if(t.showIndicators&&i.value>1)return D("div",{class:$("indicators",{vertical:t.vertical})},[Array(i.value).fill("").map(ue)])};return ee({prev:le,next:N,state:e,resize:V,swipeTo:ce}),v({size:r,props:t,count:i,activeIndicator:C}),A(()=>t.initialSwipe,a=>E(+a)),A(i,()=>E(e.active)),A(()=>t.autoplay,I),A([ge,me,()=>t.width,()=>t.height],V),A(de(),a=>{a==="visible"?I():P()}),Q(E),ye(()=>E(e.active)),pe(()=>E(e.active)),xe(P),Se(P),he("touchmove",se,{target:s}),()=>{var a;return D("div",{ref:o,class:$()},[D("div",{ref:s,style:ie.value,class:$("track",{vertical:t.vertical}),onTouchstartPassive:oe,onTouchend:L,onTouchcancel:L},[(a=f.default)==null?void 0:a.call(f)]),re()])}}});const $e=G(Ie),[ze,Ae]=j("swipe-item");var De=q({name:ze,setup(t,{slots:u}){let f;const o=J({offset:0,inited:!1,mounted:!1}),{parent:s,index:e}=Te(ae);if(!s)return;const d=T(()=>{const v={},{vertical:i}=s.props;return s.size.value&&(v[i?"height":"width"]=`${s.size.value}px`),o.offset&&(v.transform=`translate${i?"Y":"X"}(${o.offset}px)`),v}),c=T(()=>{const{loop:v,lazyRender:i}=s.props;if(!i||f)return!0;if(!o.mounted)return!1;const r=s.activeIndicator.value,h=s.count.value-1,m=r===0&&v?h:r-1,S=r===h&&v?0:r+1;return f=e.value===r||e.value===m||e.value===S,f}),b=v=>{o.offset=v};return Q(()=>{Z(()=>{o.mounted=!0})}),ee({setOffset:b}),()=>{var v;return D("div",{class:Ae(),style:d.value},[c.value?(v=u.default)==null?void 0:v.call(u):null])}}});const Xe=G(De);export{$e as S,Xe as a,Ee as b,ee as u};
