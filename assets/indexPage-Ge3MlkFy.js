import"./index-CoLxLmKc.js";import{N as P}from"./index-DlkJL-FJ.js";import{d as U,r as o,o as g,b as h,c as F,q as l,k as _,C,A as L,t as B,v as M,F as R,u as q,_ as A}from"./index-45IKlSZ7.js";import{i as b,u as E}from"./request-2uo1PmCe.js";import"./use-placeholder-Fv3Yvx8G.js";const N=()=>b.get("/captcha/image",{headers:{platform:"H5"}}),K=(v,u,y)=>b.post("/captcha/sendSmsCaptcha",{headers:{platform:"H5"},form:{captchaCode:v,captchaKey:u,mobile:y}}),j=(v,u)=>b.post("/passport/login",{headers:{platform:"H5"},form:{isParty:!1,mobile:u,partyData:{},smsCode:v}}),z={action:""},G={class:"box"},J={class:"register"},O={class:"cell-phone"},Q={class:"identifying-code"},W=["src"],X={class:"message-authentication-code"},Y={key:1},Z={class:"tips"},$=U({__name:"indexPage",setup(v){const u=q(),y=()=>{u.go(-1)},T=o(!0),k=o(""),i=o(""),c=o(60),n=o(),d=o(""),m=o(""),e=o(!1),t=o(""),I=E();N().then(s=>{i.value=s.data.data.base64,k.value=s.data.data.key});const S=()=>{N().then(s=>{i.value=s.data.data.base64,k.value=s.data.data.key})};let p=null,f=null,V=null,x=null;const w=async()=>{var s;if(clearTimeout(p),clearTimeout(f),((s=n.value)==null?void 0:s.length)!==11)e.value=!0,t.value="请输入手机号",p=setTimeout(()=>{e.value=!1,t.value=""},2e3);else if(d.value.length!==4)e.value=!0,t.value="请输入图形验证码",f=setTimeout(()=>{e.value=!1,t.value=""},2e3);else{T.value=!1;let a=setInterval(()=>{c.value--,c.value<=0&&(clearInterval(a),T.value=!0,c.value=60)},1e3);K(i.value,k.value,n.value),e.value=!0,t.value="短信验证码已发送",setTimeout(()=>{e.value=!1,t.value=""},2e3)}},D=()=>{var s;clearTimeout(p),clearTimeout(f),clearTimeout(V),clearTimeout(x),((s=n.value)==null?void 0:s.length)!==11?(e.value=!0,t.value="请输入手机号",p=setTimeout(()=>{e.value=!1,t.value=""},2e3)):d.value.length!==4?(e.value=!0,t.value="请输入图形验证码",f=setTimeout(()=>{e.value=!1,t.value=""},2e3)):m.value.length!==6?(e.value=!0,t.value="请输入短信验证码",V=setTimeout(()=>{e.value=!1,t.value=""},2e3)):j(m.value,n.value).then(a=>{a.data.status===200?(e.value=!0,t.value="登录成功",x=setTimeout(()=>{e.value=!1,t.value=""},2e3),I.token=a.data.data.token,I.userId=a.data.data.userId,u.push("/")):(e.value=!0,t.value=a.data.message,x=setTimeout(()=>{e.value=!1,t.value=""},2e3))})};return(s,a)=>{const H=P;return g(),h(R,null,[F(H,{title:"会员登录","left-arrow":"",onClickLeft:y}),l("form",z,[l("div",G,[a[4]||(a[4]=l("div",{class:"content"},[l("p",null,"手机号登录"),l("p",null,"未注册的手机号登录后将自动注册")],-1)),l("div",J,[l("div",O,[_(l("input",{"onUpdate:modelValue":a[0]||(a[0]=r=>n.value=r),type:"text",name:"",id:"",placeholder:"请输入手机号",maxlength:"11"},null,512),[[C,n.value]])]),l("div",Q,[_(l("input",{"onUpdate:modelValue":a[1]||(a[1]=r=>d.value=r),type:"text",name:"",id:"",placeholder:"请输入图形验证码",maxlength:"4"},null,512),[[C,d.value]]),i.value?(g(),h("img",{key:0,src:i.value,alt:"",onClick:S},null,8,W)):L("",!0)]),l("div",X,[_(l("input",{"onUpdate:modelValue":a[2]||(a[2]=r=>m.value=r),type:"text",name:"",id:"",placeholder:"请输入短信验证码",maxlength:"6"},null,512),[[C,m.value]]),T.value?(g(),h("span",{key:0,onClick:w},a[3]||(a[3]=[l("p",null,"获取验证码",-1)]))):(g(),h("span",Y,"重新发送("+B(c.value)+")秒",1))])])])]),l("button",{type:"submit",onClick:D},"登录"),l("div",Z,[_(l("span",null,B(t.value),513),[[M,e.value]])])],64)}}}),oe=A($,[["__scopeId","data-v-a5a844f8"]]);export{oe as default};
