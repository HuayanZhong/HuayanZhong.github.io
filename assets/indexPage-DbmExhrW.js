import"./index-D5IVMRjW.js";import{N as P}from"./index-C3MT3zNx.js";import{d as U,r as o,b as g,c as E,u as l,s as h,E as C,B as F,x as V,v as L,F as M,D as R,o as _,_ as K}from"./index-CoNTkAIC.js";import{i as b,u as j}from"./request-CYPSLcde.js";import"./use-placeholder-CGb2ZCAm.js";const N=()=>b.get("/captcha/image",{headers:{platform:"H5"}}),q=(v,u,y)=>b.post("/captcha/sendSmsCaptcha",{headers:{platform:"H5"},form:{captchaCode:v,captchaKey:u,mobile:y}}),z=(v,u)=>b.post("/passport/login",{headers:{platform:"H5"},form:{isParty:!1,mobile:u,partyData:{},smsCode:v}}),A={action:""},G={class:"box"},J={class:"register"},O={class:"cell-phone"},Q={class:"identifying-code"},W=["src"],X={class:"message-authentication-code"},Y={key:1},Z={class:"tips"},$=U({__name:"indexPage",setup(v){const u=R(),y=()=>{u.go(-1)},T=o(!0),x=o(""),i=o(""),c=o(60),n=o(),d=o(""),m=o(""),e=o(!1),a=o(""),B=j();N().then(s=>{i.value=s.data.data.base64,x.value=s.data.data.key});const S=()=>{N().then(s=>{i.value=s.data.data.base64,x.value=s.data.data.key})};let p=null,f=null,I=null,k=null;const w=async()=>{var s;if(clearTimeout(p),clearTimeout(f),((s=n.value)==null?void 0:s.length)!==11)e.value=!0,a.value="请输入手机号",p=setTimeout(()=>{e.value=!1,a.value=""},2e3);else if(d.value.length!==4)e.value=!0,a.value="请输入图形验证码",f=setTimeout(()=>{e.value=!1,a.value=""},2e3);else{T.value=!1;let t=setInterval(()=>{c.value--,c.value<=0&&(clearInterval(t),T.value=!0,c.value=60)},1e3);q(i.value,x.value,n.value),e.value=!0,a.value="短信验证码已发送",setTimeout(()=>{e.value=!1,a.value=""},2e3)}},D=()=>{var s;clearTimeout(p),clearTimeout(f),clearTimeout(I),clearTimeout(k),((s=n.value)==null?void 0:s.length)!==11?(e.value=!0,a.value="请输入手机号",p=setTimeout(()=>{e.value=!1,a.value=""},2e3)):d.value.length!==4?(e.value=!0,a.value="请输入图形验证码",f=setTimeout(()=>{e.value=!1,a.value=""},2e3)):m.value.length!==6?(e.value=!0,a.value="请输入短信验证码",I=setTimeout(()=>{e.value=!1,a.value=""},2e3)):z(m.value,n.value).then(t=>{t.data.status===200?(e.value=!0,a.value="登录成功",k=setTimeout(()=>{e.value=!1,a.value=""},2e3),B.token=t.data.data.token,B.userId=t.data.data.userId,u.push("/")):(e.value=!0,a.value=t.data.message,k=setTimeout(()=>{e.value=!1,a.value=""},2e3))})};return(s,t)=>{const H=P;return _(),g(M,null,[E(H,{title:"会员登录","left-arrow":"",onClickLeft:y}),l("form",A,[l("div",G,[t[4]||(t[4]=l("div",{class:"content"},[l("p",null,"手机号登录"),l("p",null,"未注册的手机号登录后将自动注册")],-1)),l("div",J,[l("div",O,[h(l("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>n.value=r),type:"text",name:"",id:"",placeholder:"请输入手机号",maxlength:"11"},null,512),[[C,n.value]])]),l("div",Q,[h(l("input",{"onUpdate:modelValue":t[1]||(t[1]=r=>d.value=r),type:"text",name:"",id:"",placeholder:"请输入图形验证码",maxlength:"4"},null,512),[[C,d.value]]),i.value?(_(),g("img",{key:0,src:i.value,alt:"",onClick:S},null,8,W)):F("",!0)]),l("div",X,[h(l("input",{"onUpdate:modelValue":t[2]||(t[2]=r=>m.value=r),type:"text",name:"",id:"",placeholder:"请输入短信验证码",maxlength:"6"},null,512),[[C,m.value]]),T.value?(_(),g("span",{key:0,onClick:w},t[3]||(t[3]=[l("p",null,"获取验证码",-1)]))):(_(),g("span",Y,"重新发送("+V(c.value)+")秒",1))])])])]),l("button",{type:"submit",onClick:D},"登录"),l("div",Z,[h(l("span",null,V(a.value),513),[[L,e.value]])])],64)}}}),oe=K($,[["__scopeId","data-v-a5a844f8"]]);export{oe as default};
